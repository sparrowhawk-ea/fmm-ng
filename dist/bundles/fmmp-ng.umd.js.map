{"version":3,"file":"fmmp-ng.umd.js","sources":["../../src/lib/fmm-ng.module.ts","../../src/fmmp-ng.ts"],"sourcesContent":["import { Component, ElementRef, EventEmitter, Input, NgModule, OnChanges, OnDestroy, OnInit, Output } from '@angular/core';\nimport { AbstractControl, FormGroup } from '@angular/forms';\nimport { Subscription } from 'rxjs';\nimport {\n\tFmm,\n\tFmmElementFactory,\n\tFmmFramework,\n\tFmmMapString,\n\tFmmMinimap,\n\tFmmMinimapCreateParam,\n\tFmmMinimapSnapshot,\n\tFmmPanel,\n\tFmmStore,\n\tFmmStoreItem,\n\tFmmWidgetFactory\n} from '@fmmp/core';\n\n// =================================================================================================================================\n//\t\t\t\t\t\tF M M N G M I N I M A P\n// =================================================================================================================================\n@Component({ selector: 'fmm-ng-minimap', template: '' })\nexport class FmmNgMinimap implements OnChanges, OnDestroy, OnInit, Partial<FmmMinimap> {\n\t@Input() private readonly aggregateLabels?: FmmMapString;\n\t@Input() private readonly anchor: HTMLElement;\n\t@Input() private readonly debounceMsec: number;\n\t@Input() private readonly dynamicLabels?: string[];\n\t@Input() private readonly formGroup: FormGroup;\n\t@Input() private readonly framework: FmmFramework;\n\t@Input() private readonly page: HTMLElement;\n\t@Input() private readonly panel: FmmNgPanel;\n\t@Input() private readonly title: string;\n\t@Input() private readonly usePanelDetail: boolean;\n\t@Input() private readonly useWidthToScale: boolean;\n\t@Input() private readonly verbosity = 0;\n\t@Input() private readonly widgetFactories?: FmmWidgetFactory[];\n\t@Input() private customWidgetIds: string[];\n\t@Input() private key: string;\n\t@Input() private namelessControls: FmmNgNamelessControls;\n\t@Output() private readonly update = new EventEmitter<FmmMinimapSnapshot>();\n\tprivate readonly form: HTMLFormElement;\n\n\tprivate minimap: FmmMinimap;\n\tprivate previousKey: string;\n\tprivate store: Store;\n\n\t// =============================================================================================================================\n\tpublic constructor(hostRef: ElementRef) {\n\t\tlet form = hostRef.nativeElement as Element;\n\t\twhile (form && form.tagName !== 'FORM') form = form.parentElement;\n\t\tthis.form = form as HTMLFormElement;\n\t}\n\n\t// =============================================================================================================================\n\tpublic ngOnChanges(): void {\n\t\tif (!this.minimap) return;\n\t\tif (this.key !== this.previousKey) {\n\t\t\tthis.minimap.destructor();\n\t\t\tthis.ngOnInit();\n\t\t} else {\n\t\t\tthis.store.namelessControls = this.namelessControls;\n\t\t\tthis.minimap.compose(this.customWidgetIds);\t\n\t\t}\n\t}\n\n\t// =============================================================================================================================\n\tpublic ngOnDestroy(): void {\n\t\tif (!this.minimap) return;\n\t\tthis.minimap.detach();\n\t\tthis.store = undefined;\n\t}\n\n\t// =============================================================================================================================\n\tpublic ngOnInit(): void {\n\t\tconst p: FmmMinimapCreateParam = {\n\t\t\taggregateLabels: this.aggregateLabels,\n\t\t\tanchor: this.anchor,\n\t\t\tdebounceMsec: this.debounceMsec,\n\t\t\tdynamicLabels: this.dynamicLabels,\n\t\t\tform: this.form,\n\t\t\tframework: this.framework,\n\t\t\tonUpdate: (snapshot: FmmMinimapSnapshot) => this.update.next(snapshot),\n\t\t\tpage: this.page,\n\t\t\tstore: this.store = new Store(this.formGroup),\n\t\t\ttitle: this.title,\n\t\t\tusePanelDetail: this.usePanelDetail !== undefined,\n\t\t\tuseWidthToScale: this.useWidthToScale !== undefined,\n\t\t\tverbosity: this.verbosity,\n\t\t\twidgetFactories: this.widgetFactories\n\t\t};\n\t\tconst panel = this.panel ? G.PANELMAP.get(this.panel) : undefined;\n\t\tthis.minimap = panel?.createMinimap(p);\n\t\tthis.previousKey = this.key;\n\t\tthis.ngOnChanges();\n\t}\n\n\t// =============================================================================================================================\n\tpublic takeSnapshot(): boolean {\n\t\treturn this.minimap?.takeSnapshot();\n\t}\n}\n\n// =================================================================================================================================\n//\t\t\t\t\t\tF M M N G P A N E L\n// =================================================================================================================================\n@Component({ selector: 'fmm-ng-panel', template: '' })\nexport class FmmNgPanel implements OnDestroy, OnInit, Partial<FmmPanel> {\n\t@Input() private readonly detailParent: HTMLElement;\n\t@Input() private readonly vertical: boolean;\n\n\tpublic readonly ef: FmmElementFactory;\n\tprivate minimapPanel: FmmPanel;\n\n\t// =============================================================================================================================\n\tpublic constructor(private readonly hostRef: ElementRef) {\n\t\tthis.ef = new ElementFactory(hostRef);\n\t}\n\n\t// =============================================================================================================================\n\tpublic ngOnDestroy(): void {\n\t\tthis.minimapPanel.destructor();\n\t\tG.PANELMAP.delete(this);\n\t\tthis.minimapPanel = undefined;\n\t}\n\n\t// =============================================================================================================================\n\tpublic ngOnInit(): void {\n\t\tconst host = this.hostRef.nativeElement as HTMLElement;\n\t\tconst vertical = this.vertical !== undefined;\n\t\tthis.minimapPanel = Fmm.createPanel(this.ef, host, this.detailParent, vertical);\n\t\tG.PANELMAP.set(this, this.minimapPanel);\n\t}\n\n\t// =============================================================================================================================\n\tpublic destroyDetached(): void {\n\t\treturn this.minimapPanel?.destroyDetached();\n\t}\n}\n\n// =================================================================================================================================\n//\t\t\t\t\t\tF M M N G M O D U L E\n// =================================================================================================================================\n@NgModule({ declarations: [FmmNgMinimap, FmmNgPanel], exports: [FmmNgMinimap, FmmNgPanel] })\nexport class FmmNgModule {}\n\n// =================================================================================================================================\n//\t\t\t\t\t\tF M M N G N A M E L E S S C O N T R O L S\n// =================================================================================================================================\nexport type FmmNgNamelessControls = Record<string, AbstractControl>;\n\n// =================================================================================================================================\n// =================================================================================================================================\n// =================================================\tP R I V A T E\t============================================================\n// =================================================================================================================================\n// =================================================================================================================================\n\n// =================================================================================================================================\n//\t\t\t\t\t\tE L E M E N T F A C T O R Y\n// =================================================================================================================================\nclass ElementFactory implements FmmElementFactory {\n\tprivate readonly ngContentAttribute: string;\n\n\t// =============================================================================================================================\n\tpublic constructor(ref: ElementRef) {\n\t\tlet ngContentAttribute: string; // set attribute on elements to use non-global CSS\n\t\tif (Element.prototype.getAttributeNames !== undefined) {\n\t\t\tfor (let p = ref.nativeElement as Element; p && !ngContentAttribute; p = p.parentElement) {\n\t\t\t\tconst names = p.getAttributeNames();\n\t\t\t\tngContentAttribute = names.find((a: string) => a.startsWith('_ngcontent-'));\n\t\t\t}\n\t\t} else {\n\t\t\tfor (let p = ref.nativeElement as Element; p && !ngContentAttribute; p = p.parentElement) {\n\t\t\t\tconst names = Array.prototype.map.call(p.attributes, (a: Attr) => a.name) as string[];\n\t\t\t\tngContentAttribute = names.find((a: string) => a.startsWith('_ngcontent-'));\n\t\t\t}\n\t\t}\n\t\tif (!ngContentAttribute) throw new Error('FormMinimap: missing _ngcontent- attribute');\n\t\tthis.ngContentAttribute = ngContentAttribute;\n\t}\n\n\t// =============================================================================================================================\n\tpublic createElement(tagName: string) {\n\t\tconst e = document.createElement(tagName);\n\t\te.setAttribute(this.ngContentAttribute, '');\n\t\treturn e;\n\t}\n\n\t// =============================================================================================================================\n\tpublic createElementNS(namespaceURI: string, qualifiedName: string) {\n\t\tconst e = document.createElementNS(namespaceURI, qualifiedName);\n\t\te.setAttribute(this.ngContentAttribute, '');\n\t\treturn e;\n\t}\n}\n\n// =================================================================================================================================\n//\t\t\t\t\t\tG\n// =================================================================================================================================\nconst G: {\n\tPANELMAP: WeakMap<FmmNgPanel, FmmPanel>;\n} = {\n\tPANELMAP: new WeakMap()\n};\n\n// =================================================================================================================================\n//\t\t\t\t\t\tS T O R E I T E M\n// =================================================================================================================================\nclass StoreItem implements FmmStoreItem {\n\tprivate readonly se: HTMLSelectElement;\n\n\t// =============================================================================================================================\n\tpublic constructor(\n\t\te: HTMLElement,\n\t\tlistener: EventListener,\n\t\tprivate readonly name: string,\n\t\tprivate readonly control: AbstractControl\n\t) {\n\t\tthis.se = e.tagName === 'SELECT' ? (e as HTMLSelectElement) : undefined;\n\t\tconst subscription = new Subscription();\n\t\tsubscription.add(this.control.statusChanges.subscribe(listener));\n\t\tsubscription.add(this.control.valueChanges.subscribe(listener));\n\t\tthis.destructor = () => subscription.unsubscribe();\n\t}\n\n\t// =============================================================================================================================\n\tpublic destructor(): void {\n\t\t// function body overwritten in constructor\n\t}\n\n\t// =============================================================================================================================\n\tpublic getError(hasValue: boolean): string {\n\t\tconst errors = this.control.errors;\n\t\tlet keys = errors ? Object.keys(errors) : [];\n\t\tif (hasValue && keys.length) keys = keys.filter(k => k !== 'required'); // IE11 SELECT bug\n\t\treturn keys.length ? keys.join(',') : undefined;\n\t}\n\n\t// =============================================================================================================================\n\tpublic getName(): string {\n\t\treturn this.name;\n\t}\n\n\t// =============================================================================================================================\n\tpublic getValue() {\n\t\tconst value = this.control.value as unknown;\n\t\tif (!value) return undefined;\n\t\tif (!this.se) return value;\n\t\tif (!this.se.multiple) return [this.se.selectedIndex];\n\t\tconst indexes: number[] = []; // FormControl for multiselect doesn't update when selected option is removed dynamically\n\t\tArray.from(this.se.options).forEach((o, i) => o.selected && indexes.push(i));\n\t\treturn indexes;\n\t}\n\n\t// =============================================================================================================================\n\tpublic isDisabled() {\n\t\treturn this.control.disabled;\n\t}\n}\n\n// =================================================================================================================================\n//\t\t\t\t\t\tS T O R E\n// =================================================================================================================================\nclass Store implements FmmStore {\n\tpublic namelessControls: FmmNgNamelessControls = {};\n\tprivate readonly listener: EventListener;\n\tprivate readonly minimaps: Set<FmmMinimap> = new Set();\n\n\t// =============================================================================================================================\n\tpublic constructor(private readonly formGroup: FormGroup) {\n\t\tthis.listener = () => this.minimaps.forEach(m => m.takeSnapshot());\n\t}\n\n\t// =============================================================================================================================\n\tpublic createStoreItem(e: HTMLElement, _: () => FmmStoreItem) {\n\t\tconst name = e.getAttribute('name') || e.id;\n\t\tconst control = name ? this.namelessControls[name] : undefined;\n\t\tif (control) return new StoreItem(e, this.listener, name, control);\n\t\tlet inFormArray = false;\n\t\tlet path: string;\n\t\tlet fc = e;\n\t\tfor (; fc && fc.tagName !== 'FORM'; fc = fc.parentElement) {\n\t\t\tpath = fc.getAttribute('formcontrolname') || fc.dataset.formcontrolname;\n\t\t\tif (path) break;\n\t\t\tinFormArray = fc.dataset.fmminformarray !== undefined;\n\t\t\tif (inFormArray) break;\n\t\t}\n\t\tfor (let p = fc?.parentElement; p && p.tagName !== 'FORM'; p = p.parentElement) {\n\t\t\tlet pName = p.getAttribute('formarrayname');\n\t\t\tif (!pName) {\n\t\t\t\tpName = p.getAttribute('formgroupname');\n\t\t\t\tif (pName) path = pName + '.' + path;\n\t\t\t} else if (!inFormArray) {\n\t\t\t\tpath = pName + '.' + path;\n\t\t\t} else {\n\t\t\t\tinFormArray = false;\n\t\t\t\tpath = pName;\n\t\t\t}\n\t\t}\n\t\tconst ac = this.formGroup.get(path);\n\t\treturn ac ? new StoreItem(e, this.listener, path, ac) : undefined;\n\t}\n\n\t// =============================================================================================================================\n\tpublic notifyMinimap(minimap: FmmMinimap, on: boolean) {\n\t\tif (on) this.minimaps.add(minimap);\n\t\telse this.minimaps.delete(minimap);\n\t}\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["EventEmitter","Component","ElementRef","Input","Output","Fmm","NgModule","Subscription"],"mappings":"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"}